ExpectedValue <- n * p1
#검정통계량
evTrue <- n * p1
((80-n)-evFalse)^2/evTrue + (n-evFalse)^2/evFalse
evTrue <- n * pTrue
evFalse <- n * pFalse
"검정통계량"
((80-n)-evFalse)^2/evTrue + (n-evFalse)^2/evFalse
((80-n)-evFalse)^2/evTrue + (n-evFalse)^2/evFalse)
(((80-n)-evFalse)^2 /evTrue + (n-evFalse)^2/evFalse)
evFalse <- n * pFalse
n <- 80
pTrue <- 0.85
pFalse <- 0.15
alpha <- 0.05
#검정통계량
evTrue <- n * pTrue
evFalse <- n * pFalse
"검정통계량"
(((80-n)-evFalse)^2 /evTrue + (n-evFalse)^2/evFalse)
([((80-n)-evFalse)^2] /evTrue + [(n-evFalse)^2]/evFalse)
((((80-n)-evFalse)^2) /evTrue + [(n-evFalse)^2]/evFalse)
((((80-n)-evFalse)^2) /evTrue + (n-evFalse)^2/evFalse)
evTrue
evFalse
(((64-evFalse)^2) /evTrue + (n-evFalse)^2/evFalse)
(((64-evFalse)^2) /evTrue + ((16-evFalse)^2)/evFalse)
(((64-evTrue)^2) /evTrue + ((16-evFalse)^2)/evFalse)
1 - pchisq(t.s, df=79)
t.s <- (((64-evTrue)^2) /evTrue + ((16-evFalse)^2)/evFalse)
1 - pchisq(t.s, df=79)
1 - pchisq(t.s, df=3)
1 - pchisq(t.s, df=1)
1 - pchisq(t.s, df=1)
1 - pchisq(t.s, df=1)
chisq.test(16/80, p = 0.15)
qchisq(1.568, 1)
qchisq(0.568, 1)
1 - pchisq(2.14, df=1)
1 - pchisq(2.14, df=3)
1 - qchisq(2.14, df=3)
1 - qchisq(2.14, df=3)
qchisq(2.14, df=3)
[chisq(2.14, df=3)
pchisq(2.14, df=3)
pchisq(t.s, df=3)
pchisq(t.s, df=1)
1- pchisq(t.s, df=1)
"p-value"
1 - pchisq(t.s, df=1)
d.none <- c(13,23,119)
#11-2
d.more <- c(23,21,63)
d.less <- c(31,48,159)
d.none <- c(13,23,119)
data.frame(row.names = c("1갑 이상", "1갑 이하", "안 피움"), d.more, d.less, dd.none)
data.frame(row.names = c("1갑 이상", "1갑 이하", "안 피움"), d.more, d.less, d.none)
data.frame(col.names = c("1갑 이상", "1갑 이하", "안 피움"), d.more, d.less, d.none)
data.frame( colnames(c("1갑 이상", "1갑 이하", "안 피움")), d.more, d.less, d.none)
data.frame( column.names = c("1갑 이상", "1갑 이하", "안 피움"), d.more, d.less, d.none)
data.frame(  d.more, d.less, d.none)
s.none <- c(63,159,119)
#11-2
s.more <- c(23,31,13)
s.less <- c(21,48,23)
data.frame(row.names = c("반병 이상", "반병 이하", "못마심")  s.more, s.less, s.none)
data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- sum(smokeDrink)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- sum(smokeDrink$s.more:smokeDrink$s.none )
smokeDrink
smokeDrink$Sum <- sum(row())
smokeDrink$Sum <- sum(row(smokeDrink))
smokeDrink
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
smokeDrink
smokeDrink <- row.names("Sum") = c(sum(smokeDrink$s.more))
smokeDrink <- row.names("Sum")
smokeDrink
smokeDrink <- row.names("Sum")
smokeDrink
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
smokeDrink <- rbind("sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink
View(smokeDrink)
sumRow <- ("sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
sumRow <- (row.names("Sum"), sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
sumRow <- (row.names("Sum"), sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink[nrow(smokeDrink)+1,] <- list("Sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink[nrow(smokeDrink)+1,] <- matrix("Sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink[nrow(smokeDrink)+1,] <- c("Sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink[nrow(smokeDrink)+1,] <- ("Sum", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
smokeDrink[nrow(smokeDrink)+1,] <- ( sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
newRow <-
smokeDrink1 <- smokeDrink %>%
mutate(sum(s.more), sum(s.less), sum(s.none))
newRow <-
smokeDrink1 <- smokeDrink %>%
mutate("sum",sum(s.more), sum(s.less), sum(s.none))
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계계"),  s.more, s.less, s.none)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none, sum(column())
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none, sum(column()))
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none, NA)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none, 5)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none, NA)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심","계"),  s.more, s.less, s.none)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
newRow <- data.fram(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none, smokeDrink$Sum))
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none, smokeDrink$Sum))
smokeDrink <- rbind(smokeDrink,newRow)
newRow
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), smokeDrink$Sum))
newRow
smokeDrink <- rbind(smokeDrink,newRow)
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), smokeDrink$Sum)
newRow <- data.frame(row.name = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), smokeDrink$Sum)
newRow
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), smokeDrink$Sum)
newRow
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
newRow
smokeDrink <- rbind(smokeDrink,newRow)
smokeDrink
names(smokeDrink)
names(newRow) <- names(smokeDrink)
smokeDrink <- rbind(smokeDrink,newRow)
smokeDrink
(s.n <- margin.table(smokeDrink, margin=1))
(s.n <- margin.table(smokeDrink$s.more, margin=1))
(s.n <- margin.table(smokeDrink, margin=2))
UCBAdmissions
ucba.tab
tab <- apply(smokeDrink,c(1,2),sum)
tab
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
tab <- apply(smokeDrink,c(1,2),sum)
tab
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
newRow
smokeDrink <- rbind(smokeDrink,newRow)
names(newRow) <- names(smokeDrink)
smokeDrink
(s.n <- margin.table(smokeDrink, margin=2))
ucba.tab <- apply(UCBAdmissions, c(1,2), sum)
round(prop.table(tab,margin =2) *100,1)
a.n <- margin.table(tab, margin =1)
g.n <- margin.table(tab, margin= 2)
g.n
a.n
s.n <- margin.table(tab, margin =1)
d.n <- margin.table(tab, margin= 2)
(d.p <- d.n/margin.table(tab))
(s.p <- s.n/margin.table(tab))
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
(expected <- margin.table(tab) * (s.p %*% t(d.p)))
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
addmargins(o.e)
chi sq.t <- sum(o.e)
chi sqrt <- sum(o,e) #검정 통계량
chisq.t <- sum(o,e) #검정 통계량
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=1) #p value
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=1) #p value
UCBAdmissions
ucba.tab <- apply(UCBAdmissions, c(1, 2), sum)
round(prop.table(ucba.tab, margin=2) * 100, 1)
# 독립성 검정
(a.n <- margin.table(ucba.tab, margin=1))
(g.n <- margin.table(ucba.tab, margin=2))
(a.p <- a.n / margin.table(ucba.tab))
(g.p <- g.n / margin.table(ucba.tab))
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
addmargins( expected )
## chi-square statistic
o.e <- (ucba.tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e)
chisq.t
qchisq(0.95, df=1)
1-pchisq(112.250, df=1)
1-pchisq(chisq.t, df=1)
data(UCBAdmissions)
UCBAdmissions
ucba.tab <- apply(UCBAdmissions, c(1, 2), sum)
round(prop.table(ucba.tab, margin=2) * 100, 1)
# 독립성 검정
(a.n <- margin.table(ucba.tab, margin=1))
(g.n <- margin.table(ucba.tab, margin=2))
(a.p <- a.n / margin.table(ucba.tab))
(g.p <- g.n / margin.table(ucba.tab))
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
addmargins( expected )
## chi-square statistic
o.e <- (ucba.tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e)
chisq.t
qchisq(0.95, df=1)
1-pchisq(112.250, df=1)
1-pchisq(chisq.t, df=1)
chisq.test(ucba.tab)
## continuity correction
o.e2 <- (abs(ucba.tab - expected)-0.5)^2 / expected
sum(o.e2)
chisq.test(ucba.tab, correct=FALSE)
chisq.t
qchisq(0.95, df=1)
qchisq(0.95, df=1)
1-pchisq(112.250, df=1)
1-pchisq(chisq.t, df=1)
chisq.test(ucba.tab)
chisq.test(tab)
qchisq(chisq.t, df=1) #p value
qchisq(chisq.t, df=2) #p value
addmargins(expected)
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none), sum(smokeDrink$Sum))
newRow
smokeDrink <- rbind(smokeDrink,newRow)
names(newRow) <- names(smokeDrink)
smokeDrink
tab <- apply(smokeDrink,c(1,2),sum)
tab
round(prop.table(tab,margin =2) *100,1)
s.n <- margin.table(tab, margin =1)
d.n <- margin.table(tab, margin= 2)
(s.p <- s.n/margin.table(tab))
(d.p <- d.n/margin.table(tab))
(expected <- margin.table(tab) * (s.p %*% t(d.p)))
addmargins(expected)
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
addmargins(o.e)
(expected <- margin.table(ucba.tab) * (a.p %*% t(g.p)))
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=2) #p value
pchisq(chisq.t, df=2) #p value
chisq.test(tab)
chisq.test(tab)
tab
ucba.tab
class(tab)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none))
smokeDrink
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink
tab <- apply(smokeDrink,c(1,2),sum)
tab
s.n <- margin.table(tab, margin =1)
d.n <- margin.table(tab, margin= 2)
s.n
(s.p <- s.n/margin.table(tab))
(d.p <- d.n/margin.table(tab))
(expected <- margin.table(tab) * (s.p %*% t(d.p)))
addmargins(expected)
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=2) #p value
qchisq(chisq.t, df=3) #p value
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink
tab <- apply(smokeDrink,c(1,2,3),sum)
tab <- apply(smokeDrink,c(1,2),sum)
tab
UCBAdmissions
ucba.tab
s.n <- margin.table(smokeDrink, margin =1)
round(prop.table(smokeDrink,margin =2) *100,1)
tab <- apply(smokeDrink,c(1,2),sum)
tab
round(prop.table(tab,margin =2) *100,1)
round(prop.table(tab,margin =2) ,1)
s.n <- margin.table(tab, margin =1)
d.n <- margin.table(tab, margin= 2)
(s.p <- s.n/margin.table(tab))
(d.p <- d.n/margin.table(tab))
(expected <- margin.table(tab) * (s.p %*% t(d.p)))
addmargins(expected)
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=2) #p value
chisq.test(tab)
setwd("D:/workspace/R_Statistics/과제/과제11")
a <- c(15.5, 14.3, 16.3, 13.5, 15.7, 16.4, 14.7)
b <- c(14.7, 16.3, 15.5, 15.2, 16.3, 13.5, 15.4)
c <- c(15.5, 13.2, 16.5, 15.7, 15.3, 15.2, 14.8)
veggies <- data.frame(a,b,c)
veggies <- melt(veggies, variable.name = "Vegetable", value.name = "Price")
ow <- lm(Price~Vegetable, data = veggies)
anova(ow)
# p value = 0.9824 유의수준 0.05 보다 높기 때문에 영가설 기각을 실패함으로써 채소 3개의 가격이 같다고 할 수 있다.
lake1 <- c(5, 7, 6, 8, 6, 7, 8, 8, 6, 10)
lake2 <- c(6, 8, 9, 11, 13, 12, 10, 8, 9, 10)
lake3 <- c(14, 25, 26, 18, 19, 22, 21, 16, 20, 30)
lake <- as.data.frame(cbind(lake1,lake2,lake3))
lake_melt <- melt(lake, variable.name = "lake", value.name = "ppm")
lake_melt
#분석을 위한 통계량 계산과 오차제곱합 구하기
l1.mean <- mean(lake1)
l2.mean <- mean(lake2)
l3.mean <- mean(lake3)
sse.1 <- sum((lake1 - l1.mean)^2)
sse.2 <- sum((lake2 - l2.mean)^2)
sse.3 <- sum((lake3 - l3.mean)^2)
"오차제곱합"
(sse <- sse.1 + sse.2 + sse.3)
"오차의 자유도: "
(dfe <- (length(lake1)-1) + (length(lake2)-1) + (length(lake3) -1))
#처리 제곱합 구하기
all.lake <- c(lake1,lake2,lake3)
l.mean <- mean(all.lake)
sst.1 <- length(lake1) * sum(l1.mean - l.mean)^2
sst.2 <- length(lake2) * sum(l2.mean - l.mean)^2
sst.3 <- length(lake3) * sum(l3.mean - l.mean)^2
"처리 제곱합:"
sst <- sst.1 + sst.2 + sst.3
sst
"처리의 자유도:"
(dft <- 3-1)
#전체 제곱합과 분해된 제곱합의 합 구하기
"제곱합의 비교"
"전체 제곱합"
(tsq <- sum( (all.lake - l.mean)^2))
"분해된 제곱합의 합"
(ss <- sst+sse)
#검정 통계량 구하기
mst <- sst/dft
mse <- sse/dfe
"검정통계량:"
(f.t <- mst/mse)
#기각역을 위한 임계값 구하기
alpha <- 0.05
"유의 수준에 따른 임계값:"
(tol <- qf(1-alpha, 2,27))
"유의 확율:"
(p.value <- 1- pf(f.t,2,27))
"lm 함수와 anova() 함수를 사용한 분석"
ow <- lm(ppm~lake, data= lake_melt)
anova(ow)
# p value = 2.411e-10 로써 유의 수준 0.05 보다 낮기떄문에 영가설을 기각함으로 3개의 호수의 산소량이 같다고 할수 없다
a <- c(13.2,8.2,10.9,14.3,10.7,6.6,9.5,10.8,8.8,13.3)
b <- c(14.0,8.8,11.2,14.2,11.8,6.4,9.8,11.3,9.3,13.6)
diff <- a-b
diff
n <- length(a)
m <- mean(diff)
s <- sd(diff)
t.t <- m/(s/sqrt(n))
alpha <- 0.05
qt(alpha, df = n-1)
pt(t.t,df=n-1)
t.test(a,b, alternative = "two.sided", paired = T,
conf.level = 0.95)
#p-value = 0.008539
#reject null hypothesis
#차이가 있다.
placebo <- c(51.4,52.0,45.5,54.5,52.3,50.9,52.7,50.3,53.8,53.1)
medicine <- c(50.1,51.5,45.9,53.1,51.8,50.3,52.0,49.9,52.5,53.0)
diff <- placebo - medicine
diff
n <- length(placebo)
n
mean.diff <- mean(diff)
mean.diff
s <- sd(diff)
t.t <- mean.diff/(s/sqrt(n))
alpha <- 0.05
qt(alpha, df=9)
pt(t.t,df=9)
t.test(placebo,medicine,
alternative = "greater", paired = TRUE,
conf.level = 0.95)
#p-value = 0.003105
#able to reject null hypothesis
#치료제는 효과 있음
table(mpg$drv)
drive <- mpg %>%
filter(class == "subcompact", drv == c("f","r")) %>%
select(cty, drv)
var.test(drive$cty ~ drive$drv)
#p-value = 0.1233
#unable to reject null hypothesis
t.test(drive$cty ~ drive$drv, paired = F, var.equal = T, conf.level = 0.95)
#p-value = 0.01218
#p-value lower than 0.05
#reject null hypothesis
#driving forward and backward has a significant difference in cty mpg)
#table(mpg$fl)
premiumVregular <- mpg%>%
filter(fl == c("p","r")) %>%
select(cty, fl)
#View(premiumVregular)
var.test(premiumVregular$cty ~ premiumVregular$fl)
#p-value = 0.04918
#p value is less than 0.05 therefore cannot accept null hypothesis
t.test(premiumVregular$cty ~ premiumVregular$fl, paired = F, var.equal = F, conf.level = 0.95)
#p-value = 0.6691
#therefore cannot reject null hypothesis
#regular fuel and premium fuel does not make a significant difference in cty mpg
str(mpg)
a <- mpg[mpg$class == "subcompact", "hwy" ]
table(mpg$class)
var1 <- mpg %>%
filter(class == c("subcompact", "midsize")) %>%
select(hwy,class)
#분산의 동일성을 검정
var.test(var1$hwy ~ var1$class)
# p-value = 0.0004447
# reject null hypothesis
# 두 모집단으로부터 추출한 표본 분산의 동일성을 만족하지 못함을 확인후 평균 차이 검정으로 넘어감
#모평균 차이 검정
t.test(var1$hwy ~ var1$class, paired = F, var.equal = F, conf.level = 0.95)
# p-value = 0.7171
# fail to reject null hypothesis
# subcompact car and midsize hwy mpg has significant difference
str(Cars93)
head(Cars93)
usa.price <- Cars93[Cars93$Origin == "USA","Price"]
usa.price
nonus.price <- Cars93[Cars93$Origin == "non-USA", "Price"]
#등분 산성 TEST
var.test(Cars93[Cars93$Origin == "USA","Price"], Cars93[Cars93$Origin == "non-USA","Price"])
# p-value = 0.01387
# 표본 분산의 동일성 만족하지 못함
# 분산이 서로 다르다는 대립가설 채택
t.test(usa.price, nonus.price, paired = F, var.equal = F, conf.level =0.95)
var.test(Price ~ Origin, data = Cars93)
#p-value = 0.3428
# 차이가 없다 통계적으로 유의
#등분 산성 TEST
var.test(mpg ~ am, data = mtcars)
mtcars[mtcars$am == 1,1]
#View(mtcars[mtcars$am])
# p-value = 0.06691 등분산성 만족
#T Test
t.test(mtcars[mtcars$am ==0,1] , mtcars[mtcars$am == 1,1] ,paired = FALSE,
var.equal=TRUE, conf.level = 0.95)
#Auto Mean: 17.14 Manual Mean: 24.39
#p-value = 0.000285
# 차이가 있다 통계적으로 유의
knitr::opts_chunk$set(echo = TRUE)
library(PairedData)
library(dplyr)
library(reshape2)
#11-2
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none))
#newRow
smokeDrink <- rbind(smokeDrink,newRow)
chisq.test(tab)
#11-2
s.more <- c(23,31,13)
s.less <- c(21,48,23)
s.none <- c(63,159,119)
smokeDrink <- data.frame(row.names = c("반병 이상", "반병 이하", "못마심"),  s.more, s.less, s.none)
smokeDrink$Sum <- smokeDrink$s.more + smokeDrink$s.less + smokeDrink$s.none
newRow <- data.frame(row.names = "계", sum(smokeDrink$s.more), sum(smokeDrink$s.less), sum(smokeDrink$s.none))
#newRow
tab <- apply(smokeDrink,c(1,2),sum)
#tab
round(prop.table(tab,margin =2) ,1)
s.n <- margin.table(tab, margin =1)
d.n <- margin.table(tab, margin= 2)
(s.p <- s.n/margin.table(tab))
(d.p <- d.n/margin.table(tab))
(expected <- margin.table(tab) * (s.p %*% t(d.p)))
addmargins(expected)
#chi-squared statistics
o.e <- (tab - expected)^2 / expected
addmargins(o.e)
chisq.t <- sum(o.e) #검정 통계량
chisq.t
qchisq(chisq.t, df=2) #p value
chisq.test(tab)
